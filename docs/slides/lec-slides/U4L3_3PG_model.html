<!DOCTYPE html>
<html>
  <head>
    <title>Physiological Principles Predict Growth (3PG)</title>
    <meta charset="utf-8">
    <meta name="author" content="Aitor Ameztegui" />
    <meta name="date" content="2018-01-22" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="slides.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Physiological Principles Predict Growth (3PG)
### Aitor Ameztegui
### 2018-01-22

---







# Model 3-PG: Introduction

.pull-left[
.footnote[Landsberg &amp; Waring, 1997, ForEco]
![](img/U4/3pg/paper_Landsberg.png)
]

.pull-right[
.center[.footnote[http://3pg.forestry.ubc.ca/]]
![](img/U4/3pg/web_3pg.png)
]

---
.pull-left[
.footnote[Island Press, 2014]
![](img/U4/3pg/book_Landsberg.png)
]

.pull-right[
.center[.footnote[Academic Press 2011]]
![](img/U4/3pg/book2.png)]

---
# Download 3-PG
![](img/U4/3pg/3pg_spatial.png)]
![](img/U4/3pg/3pg_excel.png)]
![](img/U4/3pg/3pg_mix.png)]

---
# Model 3-PG: Introduction
&lt;/br&gt;
- A tree growth model based on Physiological Principles that Predict Growth

- Bridges gap between mensuration-based growth &amp; yield models and process-based, C-balance models 

- Provides dynamic predictions of biomass pools, stand attributes, stocking and soil water usage

- Applicable under changing conditions, "at the edges",  and to novel situations

- Maintains an admirable level of simplicity (at least reasonable)

---
# Model 3-PG: Introduction
![](img/U4/3pg/biomes_3pg.png)]

---
# Model 3-PG: Introduction
![](img/U4/3pg/biomes_3pg_but.png)

---
# Comparison with empirical models

.pull-left[
### Advantages
- based on wide range of conditions
- applicable under changing conditions,*at the edges*, to novel situations
- provides explanation, aids understanding


### Disadvantages
- not as widely understood as empirical growth models
- not necessarily as accurate, either
- can require data not readily available
- not suitable for mixed forests
- works better with even-aged forests]

.pull-right[
.right[![](img/U4/3pg/compare_empirical.png)]
]

---

# Things to consider about a model

### Temporal and spatial scale
### State variables*
### Inputs
### Data availability
### Outputs
--
.left[.footnote[*A state variable is one of the set of variables that are used to describe the mathematical "state" of a dynamical system. Intuitively, the state of a system describes enough about the system to determine its future behaviour in the absence of any external forces affecting the system]]

---

# A quick summary of 3-PG
![](img/U4/3PG/3pg_summary.png)

---
# Input data

.pull-left-wide[

###Climate data
- monthly mean temperature, radiation, rainfall, VPD
- observed or long-term average data

###Site &amp; Soil descriptors
- latitude
- soil texture &amp; water capacity
- fertility rating

###Stand initialisation data
- foliage, stem &amp; root biomass
- stocking
- available soil water
]

.pull-left-wide-right[![](img/U4/3pg/3pg_inputs.png)]

---

background-image:url("img/U4/3pg/3pg_conceptual.png")
# Conceptual model of forest growth

---
# Main components of 3-PG

&lt;/br&gt;
.font120[
- **Production of biomass:** environmental modification of light use efficiency; constant ratio of NPP to GPP

- **Biomass allocation:** affected by growing conditions and tree size

- **Stem mortality:** probability of death; self-thinning

- **Soil water balance:** single soil layer model; evapo-transpiration determined from Penman-Monteith equation

- **Stand properties:** from biomass pools and assumptions about specific leaf area, branch+bark fraction, and wood density
]

---

background-image:url("img/U4/3pg/3pg_conceptual.png")
# Conceptual model of forest growth

---
class: full-screen
background-image:url("img/U4/3pg/3pg_process.png")
# Causal loop in 3-PG

---

class:full-screen
background-image:url("img/U4/3pg/3pg_process_carbon balance.png")
# 3-PG is a carbon balance model
.tri-col-right[
&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;

* radiation is intercepted by the canopy
* converted to assimilates
]

.tri-col-left[
&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;
* allocated to foliage, stem &amp; roots
* lost to respiration, litterfall &amp; root turnover


]
.footnote[McMurtrie &amp; Wolf (1983) model]
---

class:full-screen
background-image:url("img/U4/3pg/3pg_process_carbon balance.png")
# 3-PG is a carbon balance model
.tri-col-right[
&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;

* radiation is intercepted by the canopy
]

.footnote[McMurtrie &amp; Wolf (1983) model]

---

# Light interception

.tri-col-left[![](img/U4/3pg/3pg_process_light.png)]
.tri-col-center[
- Light is absorbed as it passes through the canopy
- Intercepted radiation varies with LAI via Beer's law:
`$$I = I_o(1-e^{kÂ·LAI})$$`
LAI determined by SLA and foliage biomass
]
    
.tri-col-right[
![](img/U4/3pg/light_transmission.png)
![](img/U4/3pg/3pg_beer.png)
]

---
class:full-screen
background-image:url("img/U4/3pg/3pg_process_carbon balance.png")
# 3-PG is a carbon balance model
.tri-col-right[
&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;

* .gray[radiation is intercepted by the canopy]
* converted to assimilates
]

]
.footnote[McMurtrie &amp; Wolf (1983) model]
---
# Production &amp; Solar radiation

.pull-left[
- Above-ground gross production linearly related to intercepted radiation
$$ P_g = \alpha_c(1-e^{-kL})Q_0$$

- Slope is a measure of **light use efficiency (LUE)** also known as *canopy quantum efficiency* denoted by `\(\alpha_c\)`

* .font80[annual stand-level LUE stable]
* .font80[Species-specific]
* .font80[Varies with climate and site factors through simple modifiers]
    

`$$\alpha_c = f_TÂ·f_FÂ·f_NÂ·min(f_D,f\theta)Â·f_{age}Â·\alpha_c$$`


####.center[This finding is the basis for many simple growth models]
]

.pull-right[![](img/U4/3pg/radiation_growth.png)]


---
# Production: Net Primary Production (NPP)

.pull-left[- 3-PG assumes constant fraction (Y = 0.47) of GPP is lost as construction and maintenance respiration

- Net primary production is then
`$$P_n = YP_g = \epsilon Y(1-e^{-kL})Q_o$$`

- `\(Y\)` probably varies seasonally with temperature
    - this would be an issue for a daily version of 3-PG
    ]
    
.pull-right[![](img/U4/3pg/net_primary_production.png)]

---

class: middle, inverse
layout: false

# Your turn!
&lt;iframe src="https://giphy.com/embed/13awhIC2CcDaHC" width="480" height="336" frameBorder="0" class="giphy-embed" allowFullScreen&gt;&lt;/iframe&gt;

---

class: full-screen
background-image:url("img/U4/3pg/3pg_process_carbon balance.png")
# Allocation: Biomass partitioning
.tri-col-left[
&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;
* allocated to foliage, stem &amp; roots
* lost to respiration, litterfall &amp; root turnover]
---
# Allocation: Biomass partitioning

NPP is paritioned into biomass pools (tDMÂ·ha-1)
- foliage `\(W_F\)`
- aboveground woody tissue `\(W_S\)`
- roots `\(W_R\)`

Partitioning rates ( `\(\eta_F, \eta_R, \eta_S\)`) depend on site &amp; growth conditions, and also on stand DBH

Litter-fall ( `\(\gamma_F\)`) and root-turnover ( `\(\gamma_R\)`)
 als taken into account.
 
Thus:

`$$\Delta W_F = \eta_F P_n - \gamma_F W_F$$`
`$$\Delta W_R = \eta_R P_n - \gamma_R W_R$$`
$$\Delta W_S = \eta_S P_n $$
---

# Allocation in 3-PG

A simple-minded approach reproduces well-established responses to site conditions

.pull-left-wide[![](img/U4/3pg/3pg_allocation.png)]
.pull-left-wide-right[.font110[* root allocation determined by fertility &amp; available soil water (ASW) --&gt;
poor conditions favour below-ground growth

* foliage:stem allocation determined by tree size --&gt; large trees have more allocation to stem wood]]

&lt;/br&gt;
&lt;/br&gt;

.center[Dynamic changes in allocation typically observed in thinning or pruning responses are not reproduced because allocation depends on tree size]


---

# Root allocation

Root allocation affected by growth conditions and by soil fertility

.pull-left[
`$$\eta_R = \frac{\eta_{Rx}Â·\eta_{Rn}}{\eta_{Rn}+(\eta_{Rx}-\eta_{Rn})m\phi}$$`
where:

`\(m = m_o + (1-m_0)FR\)`

`\(\eta_{Rx}\)` = root allocation under poor conditions

`\(\eta_{Rn}\)` = root allocation under optimal conditions]

.pull-right[![](img/U4/3pg/3pg_allocation_root.png)]


---

# Foliage and stem allocation

Above-ground allocation is based on foliage:stem partitioning ratio

`$$\rho_{FS} = \frac{\eta_F}{\eta_S} = a_pB^{n_p}$$`
Increasing DBH decreases foliage allocation and increases stem allocation. 

.center[![](img/U4/3pg/3pg_allocation_foliage.png)]
.footnote[Waring et al 2016, For Ecol Manage]

---

# Litter-fall &amp; root-turnover

**Litter-fall** an age-dependent fraction of foliage biomass

`$$\gamma_F(t)=\frac{\gamma_{F_x}\gamma_{F_0}}{\gamma_{F_0} + (\gamma_{F_X}-\gamma_{F_0})e^{-kT}},  k = \frac{1}{t_{\gamma_F}}ln(1+\frac{\gamma_{F_X}}{\gamma_{F_0}})$$`

.pull-left[
where:

`\(\gamma_{F_0}\)` = litterfall rate at age 0

`\(\gamma_{F_X}\)` = maximum litterfall rate (may be stress-related)

`\(t_{\gamma_F}\)` = age when `\(\gamma_F = 0.5(\gamma_{F_0} + \gamma_{F_X})\)`
]

.pull-right[
![](img/U4/3pg/3pg_allocation_turnover.png)
]


**Root turnover** constant fraction of root biomass ( `\(\gamma_R\)` = 0.015 month-1)

---

class:full-screen
background-image:url("img/U4/3pg/3pg_process_environmental.png")

# Site and environmental effects

&lt;/br&gt;
Site &amp; environmental factors affect growth via simple empirical modifiers


---

# Site and environmental effects

.center[![](img/U4/3pg/NPP_formula.png)]

.center[![](img/U4/3pg/NPP_factors.png)]

---
# Growth modifiers
Each environmental factor is represented by a growth modifier, i.e. a function of the factor which varies between 0 (total limitation) and 1 (no limitation).

.center[![](img/U4/3pg/3pg_gm.png)]

---

# Growth modifiers

## Temperature growth modifier

.center[![](img/U4/3pg/3pg_gm_temp_form.png)]

.pull-left[
where:

* `\(T_a\)`	= mean monthly daily temp.
* `\(T_{min}\)`	= minimum temp. for growth
* `\(T_{opt}\)`	= optimum temp. for growth
* `\(T_{max}\)`	= maximum temp. for growth]

.pull-right[![](img/U4/3pg/3pg_gm_temp_chart.png)]

---
# Growth modifiers
## Frost growth modifier

.font120[$$f_F(d_F) = 1- k_F(\frac{d_f}{30})$$]

.pull-left[
where:

* `\(d_F\)` = number of frosty days in month
* `\(k_F\)` = number of days of production lost for each day of frost
]

.pull-right[![](img/U4/3pg/3pg_gm_frost_chart.png)]
---
# Growth modifiers
## Soil water growth modifier

.font120[
`$$f_\theta(\theta) = \frac{1}{1+[(1-\theta/\theta_x)/c_\theta]^{n_\theta}}$$`]


.pull-left[
where

* `\(\theta\)`  = current available soil water
* `\(\theta_x\)` = maximum available soil water 
* `\(c_\theta\)` = relative water deficit for 50% reduction.
* `\(n_\theta\)` = power determining shape of soil water response
]

.pull-right[![](img/U4/3pg/3pg_gm_soil_chart.png)]

---
# Growth modifiers
## VPD growth modifier

.font120[$$f_D(D) = e^{-k_DD}$$]

.pull-left[
where:

* `\(d_F\)` = number of frosty days in month
* `\(k_F\)` = number of days of production lost for each day of frost
]

.pull-right[![](img/U4/3pg/3pg_gm_vpd_chart.png)]

---
# Growth modifiers
## Age-related growth modifier

.font120[$$f_{age}(t)=\frac{1}{1+(t/r_{age}t_x)^{n_{age}}}]$$]
.pull-left[
where:

* `\(t\)` = current stand age
* `\(t_x\)` = likely max. stand age
* `\(r_age\)` = relative stand age for 50% growth reduction
* `\(n_age\)` = power determining strength of growth reduction
]

.pull-right[![](img/U4/3pg/3pg_gm_age_chart.png)]
---
# Growth modifiers
## CO2 growth modifier


.center[![](img/U4/3pg/3pg_gm_co2_form.png)]

.pull-left[
where:

* `\(CO_2\)` = current CO2 level
* `\(fCalpha_{700}\)`  = growth at 700 ppm]


.pull-right[![](img/U4/3pg/3pg_gm_co2_chart.png)]


---
# Growth modifiers

Each environmental factor is represented by a growth modifier, i.e. a function of the factor which varies between 0 (total limitation) and 1 (no limitation).

.center[![](img/U4/3pg/3pg_gm.png)]

---

class: middle, inverse
layout: false

# Your turn!
&lt;iframe src="https://giphy.com/embed/13awhIC2CcDaHC" width="480" height="336" frameBorder="0" class="giphy-embed" allowFullScreen&gt;&lt;/iframe&gt;

---
class: full-screen
background-image:url("img/U4/3pg/3pg_process_swb.png")

# Soil water balance
&lt;/br&gt;
Soil water balance via simple single layer model
.pull-left-wide-right[
&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;
* canopy conductance scaled for canopy LAI
* and affected by VPD and soil water
* ET driven by radiation (using a Penman-Montieth equation)
* feedback from soil water status into growth modifiers
]

---
# Soil water balance

* Soil water balance model has a single soil-layer

* Simple monthly balance between rainfall, irrigation and evapotranspiration

.pull-left[
`$$W_+ = max{W_x, W + R + I - E_T}$$`

* Excess over maximum storage lost as runoff or drainage

* Canopy intercepts a % of rainfall and depends on LAI up to a maximum
]

.pull-right[![](img/U4/water_balance.png)]

---
# Soil water balance

Evapotranspiration determined from a Penman-Monteith equation and canopy conductance

.pull-left[
* driven by incident solar radiation
* driven by LAI through canopy conductance
* conductance affected by site &amp; environmental factors through growth modifiers]

.pull-right[![](img/U4/penman.png)]

---

class: full-screen
background-image:url("img/U4/3pg/3pg_process_all.png")

# Stocking and mortality
&lt;/br&gt;
Stocking an essential component of 3-PG as it affects allocation through stand-mean DBH

.pull-left-wide-right[
&lt;/br&gt;
* mortality model very simple-minded
* probability of death age &amp; (potentially) stress related
* density dependent mortality implemented via self-thinning law
]

---
# Calculation of stem volume

.pull-left[
.font120[* Stem volume calculated either from
    + allometric relationship w.r.t stand DBH, 
    + or from density using]]

.pull-right[![](img/U4/m3.png)]
    
`\(V = (1 - \rho BB)W_S/\rho)\)`

.font120[where `\(\rho BB\)` is fraction of stem biomass in branch and bark and `\(\rho\)` is stem density

* Note that `\(\rho BB\)` and `\(\rho\)` can vary widely across a site and calculation of stem volume from WS can be error prone.]

---
class: full-screen
background-image: url("img/U4/3pg/stem_volume.png")
# Stem volume and mass, DBH

### 3-PG assumes even-aged stands, no variation in tree diameter

---

# Newer versions

---
# Modelling mortality: density-independent 

.pull-left-wide[Two types of mortality:
+ density independent
+ density dependent or self thinning


#### Density-independent mortality
* due to random or stress-related effects
* modelled by probability of death `\(\gamma N\)` so that
`$$\Delta N = - \gamma N * N$$`
* potentially age and stress related
* `\(\gamma N\)` increased in times of stress, e.g. in response to low long-term average `\(f_0\)`	
]

.pull-left-wide-right[![](img/U4/mort_tree.png)]

---
# Modelling mortality: density-dependent 

#### Density dependent mortality
* Self thinning-line gives maximum single-tree stem mass (kg/tree) at current stocking

`$$\omega_{Sx}(N) = \omega_{Sx0}(1000/N)^{3/2}$$`

where `\(\omega_{Sx0}\)` is max. stem mass at 1000 trees ha-1

.pull-left[* When `\(\omega_S &gt; \omega_{Sx}(N)\)`, stocking is reduced. 

Thus:

at 1: no mortality

at 2: mortality reduces population to 2']

.pull-right[![](img/U4/self_thinning.png)]
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
